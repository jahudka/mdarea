!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MarkdownArea=t()}(this,(function(){"use strict";const e=/^[ \t]*(?:(?:[-+*]|\d+\.)[ \t]+(?:\[[ x]][ \t]+)?|>[ \t]*)*(?::[ \t]*)?/,t=/(?:[-+*]|\d+\.)[ \t]+(?:\[[ x]][ \t]+)?$/,n=/[-+*\[\]x\d.]/g,i=/[^ \t]/g,l=/(\d+)\.(?=[ \t]+$)/,s=/(?:(?:^[ \t]+)?(?:[-+*]|\d+\.|[>:])(?:[ \t]+\[[ x]])?[ \t]*|^[ \t]+)$/;function o(e,t){return e.replace(t?i:n," ")}const r=/mac|iphone|ipad|ipod/i.test(navigator.platform),u=/firefox/i.test(navigator.userAgent),c=r?"metaKey":"ctrlKey",d={enter:["Enter","Shift+Enter"],indent:["Tab","Cmd+m"],outdent:["Shift+Tab","Cmd+Shift+m"],inline:['"',"'","`","*","_","[","]","(",")","{","}","<",">"]};function a(e={}){const t={},n=[];for(let i in d)if(d.hasOwnProperty(i)){let l=e[i]||d[i];Array.isArray(l)||(l=l.toString().trim().split(/\s*[|,]\s*/g)),n.push.apply(n,l.map((e=>{const n=f(e);return n.key in t||(t[n.key]=0),++t[n.key],{key:n,action:i}})))}return n.forEach((e=>{var n;t[e.key.key]>1&&("ctrlKey"in(n=e.key)||(n.ctrlKey=!1),"altKey"in n||(n.altKey=!1),"shiftKey"in n||(n.shiftKey=!1),"metaKey"in n||(n.metaKey=!1))})),n}function f(e){const t={};return e.trim().split(/\s*\+\s*/g).forEach((function(e){switch(e.toLowerCase()){case"cmd":t[c]=!0;break;case"ctrl":case"alt":case"shift":case"meta":t[e.toLowerCase()+"Key"]=!0;break;default:t.key=e}})),t}function h(e=4){return"number"!=typeof e&&(e=(e+"").length),new Array(e+1).join(" ")}const p=/[*_]/,m=/[-=\s"'`<>\[\](){}+*^$\\.|]$/,y=/^(?:\n|$)/,g=/^(?!$)/gm,b={"`":/^``$/m,"~":/^~~$/m},v={"[":"]","(":")","{":"}","<":">"},x={"]":"[",")":"(","}":"{",">":"<"};function k(){const e=document.createElement("pre");return e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.contentEditable=!0,e.textContent="",e.addEventListener("focus",(()=>setTimeout((()=>e.blur()),0))),e.style.position="fixed",e.style.overflow=e.style.visibility="hidden",e.style.left="-1000px",e.style.top="50%",e.style.width=e.style.height="1px",e.style.opacity="0",e}function E(n,i){if(!n.elem||i.defaultPrevented)return;u&&i[c]&&"z"===i.key&&n.elem.blur();const r=n.options.keyMap.find((e=>function(e,t){for(const n in t)if(t.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0}(i,e.key)));if(!r)return;const d=A(n.elem),a=d.v.substring(0,d.s),f=d.v.substring(d.s,d.e),h=d.v.substring(d.e);switch(r.action){case"enter":!function(n,i,r,u,c){const d=r?null:function(t){const n=t.lastIndexOf("\n")+1,i=t.substring(n),l=e.exec(i);return{line:i,offset:n,prefix:l&&l[0]}}(i);if(d)if(d.line&&d.line.charAt(d.line.length-1)in v){const e=d.prefix?o(d.prefix,!0):"";u="\n"+e+u,c||(i+="\n"+e+n.options.indent)}else d.prefix?!c&&d.prefix===d.line&&y.test(u)?i=i.substring(0,d.offset)+function(e){return e.replace(s,"")}(d.prefix):!c&&function(e){return t.test(e)}(d.prefix)?i+="\n"+function(e){return e.replace(l,(function(e,t){return parseInt(t)+1+"."}))}(d.prefix):i+="\n"+o(d.prefix,c):i+="\n";else i+="\n";w(n,i+u,i.length)}(n,a,f,h,i.shiftKey);break;case"indent":!function(e,t,n,i){let l=t.length,s=t.lastIndexOf("\n")+1;s<l&&(n=t.substring(s)+n,t=t.substring(0,s));(s<l||!n)&&(l+=e.options.indent.length);n?n=n.replace(g,e.options.indent):t+=e.options.indent;w(e,t+n+i,l,n?s+n.length:l)}(n,a,f,h);break;case"outdent":!function(e,t,n,i){let l=t.length,s=t.lastIndexOf("\n")+1;s<l&&(n=t.substring(s)+n,t=t.substring(0,s),n.substring(0,e.options.indent.length)===e.options.indent&&(l-=e.options.indent.length));n=n.replace(e.reOutdent,""),w(e,t+n+i,l,s+n.length)}(n,a,f,h);break;case"inline":!function(e,t,n,i,l){n||l in v||i.charAt(0)!==l?n||("'"!==l||m.test(t))&&!(l in x)?!n&&l in b&&b[l].test(t)?w(e,t+l+"language\n"+l+l+l+("\n"!==i.charAt(0)?"\n":"")+i,t.length+1,t.length+9):l===t.slice(-1)&&l===i.slice(0,1)?w(e,t.slice(0,-1)+n+i.slice(1),t.length-1,t.length-1+n.length):w(e,t+(x[l]||l)+n+(v[l]||l)+i,t.length+1,t.length+1+n.length):w(e,t+l+i,t.length+1):w(e,t+(p.test(l)?l+l:"")+i,t.length+1)}(n,a,f,h,i.key)}i.preventDefault()}function w(e,t,n,i=n){e.lock=!0,e.helper.style.visibility="";const l={s:n,e:i,v:t,x:e.elem.scrollLeft,y:e.elem.scrollTop};L(e),I(e.helper,l),O(e.elem,l),e.helper.style.visibility="hidden",e.lock=!1}function K(e,t){if(e.lock)return;e.lock=!0;const n=A(e.elem);t.preventDefault(),document.execCommand("undo"),L(e),I(e.helper,n),O(e.elem,n),e.lock=!1}function C(e){if(e.lock)return;const t=(n=e.helper,JSON.parse(n.textContent||"null"));var n;t?(e.lock=!0,O(e.elem,t),e.lock=!1):e.elem.focus()}function L(e){e.init||(e.init=!0,I(e.helper,A(e.elem)))}function A(e){return{s:e.selectionStart,e:e.selectionEnd,x:e.scrollLeft,y:e.scrollTop,v:e.value.replace(/\u00A0/g," ")}}function O(e,t){e.value=t.v,e.selectionStart=t.s,e.selectionEnd=t.e,e.scrollTo(t.x,t.y),e.focus()}function I(e,t){e.focus(),document.execCommand("selectAll"),document.execCommand("insertText",!1,JSON.stringify(t))}return class{constructor(e,t){const n=function(e={}){return{indent:h(e.indent),keyMap:a(e.keyMap)}}(t),i=this.ed={elem:e,options:n,helper:k(),reOutdent:new RegExp("^"+n.indent,"mg"),init:!1,lock:!1};i.onInput=K.bind(null,i),i.onKeyDown=E.bind(null,i),i.onUndo=C.bind(null,i),i.helper.addEventListener("input",i.onUndo),document.body.appendChild(i.helper),this.setElement(e)}getElement(){return this.ed.elem}setElement(e){this.ed.elem&&(this.ed.elem.removeEventListener("input",this.ed.onInput),this.ed.elem.removeEventListener("keydown",this.ed.onKeyDown)),this.ed.elem=e,e.addEventListener("keydown",this.ed.onKeyDown),e.addEventListener("input",this.ed.onInput),this.ed.helper.textContent="",this.ed.init=!1}getValue(){return this.ed.elem.value.replace(/\u00A0/g," ")}setValue(e,t=!1){this.ed.elem.value=e,t||(this.ed.helper.textContent="",this.ed.init=!1)}destroy(){return this.ed.elem.removeEventListener("keydown",this.ed.onKeyDown),this.ed.elem.removeEventListener("input",this.ed.onInput),this.ed.helper.removeEventListener("input",this.ed.onUndo),document.body.removeChild(this.ed.helper),Object.assign(this.ed,{elem:null,helper:null,options:null,reOutdent:null,onKeyDown:null,onInput:null,onUndo:null}),Object.assign(this,{ed:null}),null}}}));
//# sourceMappingURL=index.min.js.map
