!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.MarkdownArea=t()}("undefined"!=typeof self?self:this,function(){var n=/mac|iphone|ipad|ipod/i.test(navigator.platform)?"metaKey":"ctrlKey",f=/[*_]/,g=/^[ \t]*(?:(?:[-+*]|\d+\.)[ \t]+(?:\[[ x]][ \t]+)?|>[ \t]*)*(?::[ \t]*)?/,d=/(?:[-+*]|\d+\.)[ \t]+(?:\[[ x]][ \t]+)?$/,i=/[-+*\[\]x\d.]/g,r=/[^ \t]/g,p=/(\d+)\.(?=[ \t]+$)/,y=/(?:(?:^[ \t]+)?(?:[-+*]|\d+\.|[>:])(?:[ \t]+\[[ x]])?[ \t]*|^[ \t]+)$/,c=/^(?!$)/gm,m={"`":/^``$/m,"~":/^~~$/m},v={"[":"]","(":")","{":"}","<":">"},_={"]":"[",")":"(","}":"{",">":"<"},s={enter:["Enter","Shift+Enter"],indent:["Tab","Ctrl+m"],outdent:["Shift+Tab","Ctrl+Shift+m"],inline:['"',"'","`","*","_","[","]","(",")","{","}","<",">"]};function e(e,t){var n,i;this._options=((n=t)||(n={}),n.keyMap=function(e){e||(e={});var n={},t=[];for(var i in s)if(s.hasOwnProperty(i)){var r=e[i]||s[i];Array.isArray(r)||(r=r.toString().trim().split(/\s*[|,]\s*/g)),t.push.apply(t,r.map(function(e){return(e=l(e)).key in n||(n[e.key]=0),++n[e.key],{key:e,action:i}}))}return t.forEach(function(e){var t;1<n[e.key.key]&&("ctrlKey"in(t=e.key)||(t.ctrlKey=!1),"altKey"in t||(t.altKey=!1),"shiftKey"in t||(t.shiftKey=!1),"metaKey"in t||(t.metaKey=!1))}),t}(n.keyMap),n.indent="number"==typeof(i=n.indent||"    ")?new Array(i+1).join(" "):(i+"").replace(/[^ \t]/g," "),n.toggleInlineWrap=null==n.toggleInlineWrap||n.toggleInlineWrap,n),this._reOutdent=new RegExp("^"+this._options.indent,"mg"),this._handleKey=this._handleKey.bind(this),this.setElement(e)}function l(e){var t={};return e.trim().split(/\s*\+\s*/g).forEach(function(e){switch(e.toLowerCase()){case"ctrl":case"cmd":t[n]=!0;break;case"shift":t.shiftKey=!0;break;case"alt":t.altKey=!0;break;default:t.key=e}}),t}function k(e,t,n,i){if(e.value=t,e.selectionStart=n,e.selectionEnd=3<arguments.length?i:n,"InputEvent"in window)try{var r=new InputEvent("input");e.dispatchEvent(r)}catch(i){}}function b(e,t){return e.replace(t?r:i," ")}return e.prototype={constructor:e,getElement:function(){return this._elem},setElement:function(e){this._elem&&this._elem.removeEventListener("keydown",this._handleKey),(this._elem=e).addEventListener("keydown",this._handleKey)},getValue:function(){return this._elem.value},setValue:function(e){this._elem.value=e},destroy:function(){this._elem.removeEventListener("keydown",this._handleKey),this._elem=this._options=this._reOutdent=this._handleKey=null},_handleKey:function(t){if(!t.defaultPrevented){var e=this._options.keyMap.find(function(e){return function(e,t){for(var n in t)if(t.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0}(t,e.key)});if(e){var n=t.target.value.substring(0,t.target.selectionStart),i=t.target.value.substring(t.target.selectionStart,t.target.selectionEnd),r=t.target.value.substring(t.target.selectionEnd);switch(e.action){case"enter":!function(e,t,n,i,r,s){var l=n?null:(a=t,o=a.lastIndexOf("\n")+1,h=a.substring(o),u=g.exec(h),{line:h,offset:o,prefix:u&&u[0]});var a,o,h,u;if(n)t+="\n";else if(l.line&&l.line.charAt(l.line.length-1)in v){var f=l.prefix?b(l.prefix,!0):"";i="\n"+f+i,s||(t+="\n"+f+r)}else l.prefix?s||l.prefix!==l.line?!s&&(c=l.prefix,d.test(c))?t+="\n"+l.prefix.replace(p,function(e,t){return parseInt(t)+1+"."}):t+="\n"+b(l.prefix,s):t=t.substring(0,l.offset)+l.prefix.replace(y,""):t+="\n";var c;k(e,t+i,t.length)}(this._elem,n,i,r,this._options.indent,t.shiftKey);break;case"indent":!function(e,t,n,i,r){var s=t.length,l=t.lastIndexOf("\n")+1;l<s&&(n=t.substring(l)+n,t=t.substring(0,l));(l<s||!n)&&(s+=r.length);n?n=n.replace(c,r):t+=r;k(e,t+n+i,s,n?l+n.length:s)}(this._elem,n,i,r,this._options.indent);break;case"outdent":!function(e,t,n,i,r,s){var l=t.length,a=t.lastIndexOf("\n")+1;a<l&&(n=t.substring(a)+n,t=t.substring(0,a),n.substring(0,r.length)===r&&(l-=r.length));n=n.replace(s,""),k(e,t+n+i,l,a+n.length)}(this._elem,n,i,r,this._options.indent,this._reOutdent);break;case"inline":s=this._elem,l=n,a=i,o=r,h=t.key,u=this._options.toggleInlineWrap,a||h in v||o.charAt(0)!==h?!a&&("'"===h||h in _)?k(s,l+h+o,l.length+1):!a&&h in m&&m[h].test(l)?k(s,l+h+"language\n"+h+h+h+("\n"!==o.charAt(0)?"\n":"")+o,l.length+1,l.length+9):u&&h===l.slice(-1)&&h===o.slice(0,1)?k(s,l.slice(0,-1)+a+o.slice(1),l.length-1,l.length-1+a.length):k(s,l+(_[h]||h)+a+(v[h]||h)+o,l.length+1,l.length+1+a.length):k(s,l+(f.test(h)?h+h:"")+o,l.length+1)}t.preventDefault()}}var s,l,a,o,h,u}},e});
//# sourceMappingURL=mdarea.min.map
