!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).MarkdownAreaSuggest=e()}(this,(function(){"use strict";const t={prev:["ArrowUp","Up"],next:["ArrowDown","Down"],cancel:["Escape","ArrowLeft","Left","Cancel"],accept:["Enter","ArrowRight","Right","Tab","Accept"]};function e(e={}){const n={};for(const r in t)if(t.hasOwnProperty(r)){const s=e[r]||t[r];n[r]=Array.isArray(s)?s:s.split(/\s*,\s*/g)}return n}function n(...t){let e=!1;const n=t.map((t=>"string"==typeof t?t:(e=e||t.ignoreCase,t.source.replace(/^\^|\$$/g,"")))).join("");return new RegExp(n,e?"i":void 0)}class r{constructor(t,e){this.aborted=!1,this.load=t,this.prefix=e,this.controller="undefined"!=typeof AbortController?new AbortController:void 0}abort(){this.aborted=!0,this.controller&&this.controller.abort()}isAborted(){return this.aborted}getResult(){var t;return this.load(this.prefix,null===(t=this.controller)||void 0===t?void 0:t.signal)}}return class{constructor(t,r={}){this.load=t,this.options=function(t={}){return{pattern:n(t.pattern||"\\S+","$"),keyMap:e(t.keyMap)}}(r)}init(t){this.editor=t}cleanup(t){this.editor=void 0}handleKey(t,e,n,r){if(!this.editor)return;if(this.request&&this.request.abort(),r.ctrlKey||r.metaKey||r.altKey)return;if(1===r.key.length||"Backspace"===r.key){const e="Backspace"===r.key?t.substring(0,t.length-1):t+r.key,s=this.options.pattern.exec(e);if(s)return this.loadCandidates(s[0],e.substring(0,e.length-s[0].length),n)}if(!this.candidates)return;const s=this.candidates,i=this.options.keyMap;if(i.cancel.includes(r.key))return this.candidates=void 0,{v:t+n,s:t.length};if(i.accept.includes(r.key))return this.candidates=void 0,{v:t+e+n,s:t.length+e.length};const o=this.options.pattern.exec(t+e);if(!o||!s.includes(o[0]))return this.candidates=void 0;const a=o[0],d=a.substring(0,a.length-e.length);let h=0;if(s&&i.prev.includes(r.key)?h=-1:s&&i.next.includes(r.key)&&(h=1),h){const e=(s.length+s.indexOf(a)+h)%s.length,r=s[e].substring(d.length);return{v:t+r+n,s:t.length,e:t.length+r.length}}}loadCandidates(t,e,n){try{const s=this.request=new r(this.load,t),i=s.getResult();if(s.isAborted())return this.request=void 0;if(Array.isArray(i))return this.request=void 0,this.processCandidates(i,t,e,n);i.then((r=>{if(this.request=void 0,this.editor&&!s.isAborted()){const s=this.processCandidates(r,t,e,n);s&&this.editor.pushState(s)}}),(t=>this.handleError(t)))}catch(t){this.handleError(t)}}processCandidates(t,e,n,r){if(this.candidates=t,!t.length)return;const s=t[0];return{v:n+s+r,s:n.length+e.length,e:n.length+s.length}}handleError(t){if(this.request=void 0,!t||"abort"!==t.type)throw t}}}));
//# sourceMappingURL=index.min.js.map
