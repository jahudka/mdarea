!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).MarkdownAreaSuggest=e()}(this,(function(){"use strict";const t={prev:["ArrowUp","Up"],next:["ArrowDown","Down"],cancel:["Escape","ArrowLeft","Left","Cancel"],accept:["Enter","ArrowRight","Right","Tab","Accept"]};function e(e={}){const n={};for(const s in t)if(t.hasOwnProperty(s)){const i=e[s]||t[s];n[s]=Array.isArray(i)?i:i.split(/\s*,\s*/g)}return n}function n(...t){let e=!1;const n=t.map((t=>"string"==typeof t?t:(e=e||t.ignoreCase,t.source.replace(/^\^|\$$/g,"")))).join("");return new RegExp(n,e?"i":void 0)}class s{constructor(t,e){this.aborted=!1,this.load=t,this.prefix=e,this.controller="undefined"!=typeof AbortController?new AbortController:void 0}abort(){this.aborted=!0,this.controller&&this.controller.abort()}isAborted(){return this.aborted}getResult(){var t;return this.load(this.prefix,null===(t=this.controller)||void 0===t?void 0:t.signal)}}return class{constructor(t,s={}){this.load=t,this.options=function(t={}){const s=n("^",t.start||"\\S","$"),i=n(t.content||"\\S*");return{start:s,content:i,prefix:n(s,i,"$"),keyMap:e(t.keyMap)}}(s)}init(t){this.editor=t}cleanup(t){this.editor=void 0}handleKey(t,e,n,s){if(!this.editor)return;if(this.request&&this.request.abort(),s.ctrlKey||s.metaKey||s.altKey)return;if(1===s.key.length||"Backspace"===s.key){const e="Backspace"===s.key?t.substring(0,t.length-1):t+s.key,i=this.options.prefix.exec(e);if(i)return this.loadCandidates(i[0],e.substring(0,e.length-i[0].length),n)}if(!this.candidates)return;const i=this.candidates,r=this.options.keyMap;if(r.cancel.includes(s.key))return this.candidates=void 0,{v:t+n,s:t.length};if(r.accept.includes(s.key))return this.candidates=void 0,{v:t+e+n,s:t.length+e.length};const o=this.options.prefix.exec(t+e);if(!o||!i.includes(o[0]))return this.candidates=void 0;const a=o[0],d=a.substring(0,a.length-e.length);let h=0;if(i&&r.prev.includes(s.key)?h=-1:i&&r.next.includes(s.key)&&(h=1),h){const e=(i.length+i.indexOf(a)+h)%i.length,s=i[e].substring(d.length);return{v:t+s+n,s:t.length,e:t.length+s.length}}}loadCandidates(t,e,n){try{const i=this.request=new s(this.load,t),r=i.getResult();if(i.isAborted())return this.request=void 0;if(Array.isArray(r))return this.request=void 0,this.processCandidates(r,t,e,n);r.then((s=>{if(this.request=void 0,this.editor&&!i.isAborted()){const i=this.processCandidates(s,t,e,n);i&&this.editor.pushState(i)}}),(t=>this.handleError(t)))}catch(t){this.handleError(t)}}processCandidates(t,e,n,s){if(this.candidates=t,!t.length)return;const i=t[0];return{v:n+i+s,s:n.length+e.length,e:n.length+i.length}}handleError(t){if(this.request=void 0,!t||"abort"!==t.type)throw t}}}));
//# sourceMappingURL=index.min.js.map
